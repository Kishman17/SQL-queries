\Отчет для PVA-процессов активных, с привязкой д-ов, актывный шаг с п-ем и его email

\\Бизнес задача: Статистика активных PVA-процесов на конкретном проекте, 
на каком шаге и какой пользователь участвует на данном шаге, с персональной информацией ввиде корп email.

\\\ Описнае данных 
    ecs_doc_type_name - тип документа
    eif_contract_number - номер контракта
    object_name - имя объекта
    eif_revision - Ревизия 
    sib_revision_date - Дата Выпуска Ревизии
    arctic_document_title - Наименование документа
    sib_unit_title - Титул
    arctic_mark_stamp - Марка комплекта
    sib_doc_type_code - 	Код Типа Документа
    sib_discipline_code - Код Дисциплины
    sib_equip_item - Номенклатура
    eif_active_step - Активный шаг
\\\ Ключивые моменты в запросе 
    1. Использование подзапроса для возврата даных по документу и процессу
    2. соединение Left Join таблицы информации о пользовтаели, а так же таблицу задачи. 
select a.*,t.eif_summary,t.eifx_performer_set_name,u.user_address
from (select d.ecs_doc_type_name as d_ecs_doc_type_name ,
d.eif_contract_number as d_eif_contract_number, 
d.object_name as d_object_name,
d.eif_revision as d_eif_revision,
d.sib_revision_date as d_sib_revision_date,
d.arctic_company_number as d_arctic_company_number,
d.sib_package_revision as d_sib_package_revision,
d.eif_issue_reason as d_eif_issue_reason, 
d.arctic_document_title as d_arctic_document_title,
d.sib_unit_title as d_sib_unit_title,
d.arctic_mark_stamp as d_arctic_mark_stamp,
d.sib_doc_type_code as d_sib_doc_type_code,
d.sib_discipline_code as d_sib_discipline_code,
d.sib_equip_item as d_sib_equip_item,
d.sib_listing as d_sib_listing,
d.sib_number_of_sheets_a4 as d_sib_number_of_sheets_a4,
p.ecs_doc_type_name as p_ecs_doc_type_name,
p.r_creator_name as p_r_creator_name,	
p.r_object_id as p_r_object_id,
p.object_name as p_object_name,
p.eif_active_step as p_eif_active_step,
p.r_creation_date as p_r_creation_date,
p.eif_due_date as p_eif_due_date,
p.eif_completed_date as p_eif_completed_date,
p.ecs_lc_state as p_ecs_lc_state,
p.ecs_internal_ref
from eifx_deliverable_doc d, eif_action_process p
where any p.eif_subject_items_ref = d.ecs_internal_chron_ref
and p.ecs_doc_type_name != 'Процесс контроля качества ПП'
and d.ecs_doc_type_name IN ('Technical Task','Project Management Document','Basic Project Documentation','Initial data','Engineering Surveys Document','Detailed Design Document','FEED Documents','Project Document','Pre-FEED Documents')
and p.eif_project_context.eif_project_ref = 'KOS'
and p.ecs_lc_state = 'Active') a
left join eif_task t on a.ecs_internal_ref = t.eif_subject_int_ref
left join dm_user u on t.eifx_performer_set_name = u.user_name enable (ROW_BASED)

Пример вывода (схематично)
d_ecs_doc_type_name| d_eif_contract_number |d_object_name| d_eif_revision| d_sib_revision_date| d_arctic_company_number| d_sib_package_revision |d_eif_issue_reason|	d_arctic_document_title|	d_sib_unit_title|d_arctic_mark_stamp| d_sib_doc_type_code| d_sib_discipline_code|	d_sib_equip_item| d_sib_listing	|d_sib_number_of_sheets_a4|
|..................|.......................|.............|...............|....................|........................|........................|..................|.........................|......................................|....................|......................|.................|...............|.........................|
Detailed Design Document| 0072.2024 |CPP.0072.2024-1803-TXM.LAY-0003 |0 |12.01.2026 12:00| IFU - Выпущено для использования|Разрезы 1-1, 2-2 |1803 - Насосная противопожарного водоснабжения|TXM - Технология производства механическая | Mechanical Process Technology| LAY - План расположения (трубопроводов, оборудования, кабелей) | Layout Drawing (pipilines, equipment, cables)| A4x4-1	
